#include <iostream>
#include <fstream>
#include <locale.h>
#include <string.h>
#include <iomanip>

using namespace std;

void createtable(ifstream& in,double  *table,  const int size);
int proverka_na_open_file(ifstream& in);
void search(ofstream& out,double  *table);
int printrezult(ofstream& out,int mypower,int errpow);

int main(void)
{
	setlocale(LC_ALL,"Russian");

	ifstream in("D:\\shum.txt"); 
	proverka_na_open_file(in);

	int size=0;
	in>>size;	//считываем из файла количествоизвестных
	size=size-1;
	double  *Table = new double [size];// массив для хранения вероятности
	createtable(in,Table,size);	//считываем данные с файла в массив
	ofstream out("D:\\newshum.txt");
	search(out,Table);				//ищем неизвесные (частоту шума,частоу проверки)

	in.close();
	out.close();

	system("pause");
	return 0;
}


int proverka_na_open_file(ifstream& in) 
{
	if (!in.is_open())
	{ 
		cout<< "Невозможно открыть файл. "<<endl; 
		return 1; 
	} 
	if(in.fail())				//проверка на ошибку во время чтения
	{
		return false;
	}

	return 0;

}

void createtable(ifstream& in,double  *table,  const int size) // массив для хранения вероятности
{

	for(int i=0;i<=size;i++)
	{
		in>>table[i];
	}
	cout<<"Данные из файла считаны"<<endl;
}

void search(ofstream& out,double  *table) //ищем неизвесные (частоту шума,частоту проверки)
{
	int mypower,errpow;
	double a=0.0;
	double b=0;
	double x=1.0;
	double y=0;
	double rezult=0;
	int k=1;

	for(mypower=1;mypower<=9;mypower++)		 //подбор чисел
	{
		for(errpow=1;errpow<=9;errpow++)
		{
			y=(double)mypower/(double)errpow;//высчитываем вероятность 
			a=(double)x-(double)y;
			b=(double)y-(double)a;
			rezult=(a*b);
			
			if (abs((double)table[k]-(double)rezult) < 0.000000001) //используем такую структуру для сравнения вдух double
			{
				cout<<"Частота проверки: "<<mypower<<"  Частота шума: "<<errpow<<endl;
				printrezult(out,mypower,errpow);	//найден ответ,искать больше не нужно
			}
		}
	}
}
	
int printrezult(ofstream& out,int mypower,int errpow) //вывод в файл
{
		if (!out.is_open())
		{ 
			cout<< "Невозможно открыть файл  на запись. "<<endl;
			return false;
		}
		if(out.fail())				//проверка на ошибку во время чтения
		{
			return false;
		}
		out<<"("<<errpow<<","<<mypower<<")"<<endl;
		cout<<"Результат записан в файл"<<endl;
		return 0;
}
